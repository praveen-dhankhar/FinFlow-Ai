# PostgreSQL Security Configuration
# This file contains PostgreSQL-specific security settings for production

# Connection Security
spring.datasource.url=jdbc:postgresql://localhost:5432/finance_forecast?ssl=true&sslmode=require
spring.datasource.hikari.data-source-properties.ssl=true
spring.datasource.hikari.data-source-properties.sslmode=require

# Connection Pool Security
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.leak-detection-threshold=60000

# PostgreSQL Performance Optimizations
spring.datasource.hikari.data-source-properties.cachePrepStmts=true
spring.datasource.hikari.data-source-properties.prepStmtCacheSize=250
spring.datasource.hikari.data-source-properties.prepStmtCacheSqlLimit=2048
spring.datasource.hikari.data-source-properties.useServerPrepStmts=true
spring.datasource.hikari.data-source-properties.rewriteBatchedStatements=true
spring.datasource.hikari.data-source-properties.cacheResultSetMetadata=true
spring.datasource.hikari.data-source-properties.cacheServerConfiguration=true
spring.datasource.hikari.data-source-properties.elideSetAutoCommits=true
spring.datasource.hikari.data-source-properties.maintainTimeStats=false

# Security Headers for PostgreSQL
app.security.headers.content-security-policy=default-src 'self'; script-src 'self' 'unsafe-inline'
app.security.headers.strict-transport-security=max-age=31536000; includeSubDomains
app.security.headers.x-frame-options=DENY
app.security.headers.x-content-type-options=nosniff
app.security.headers.referrer-policy=strict-origin-when-cross-origin

# JWT Security (PostgreSQL-specific)
app.jwt.secret=${POSTGRESQL_JWT_SECRET:finance-forecast-app-postgresql-super-secret-key-2024}
app.jwt.expiration=86400000
app.jwt.refresh-expiration=604800000

# Rate Limiting (PostgreSQL-optimized)
app.security.rate-limit.requests-per-minute=100
app.security.rate-limit.burst-capacity=200
app.security.rate-limit.refill-period=60

# Database Security
app.security.database.audit-enabled=true
app.security.database.soft-delete-enabled=true
app.security.database.encryption-enabled=true

# Monitoring and Logging
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.metrics.export.prometheus.enabled=true
spring.datasource.hikari.register-mbeans=true
management.endpoint.hikaricp.enabled=true

# Logging Configuration for PostgreSQL
logging.level.org.springframework.security=INFO
logging.level.org.springframework.web=INFO
logging.level.com.financeapp.security=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE